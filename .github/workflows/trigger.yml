on:
  issue_comment:
    types:
      - created
      - edited
      - deleted
  workflow_dispatch:


jobs:
  like-pizza:
    runs-on: ubuntu-latest
    if: ${{ github.event.comment.body == 'pizza'}}
    steps:
      - name: Like pizza
        uses: actions/github-script@v4
        with:
          script: |
            const {owner, repo} = context.issue
            github.reactions.createForIssueComment({
              owner,
              repo,
              comment_id: context.payload.comment.id,
              content: "+1",
            });

  trigger-quality-gate:
    runs-on: ubuntu-latest
    steps:
      - name: Prepare Permissions
        run: sudo chown ubuntu:ubuntu -R ../*

      - name: Checkout
        uses: actions/checkout@v3
        with:
          token: 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

      - name: Ensure Clean Checkout
        run: |
          rm -rf .git .github node_modules packages
          rm -f package-lock.json

      - name: Trigger
        uses: ./.github/workflows/quality-gate
        with:
          e2e-branch: "Passed input data branch name from triggerrrrrrr"


      # # - name: GitHub Environment Variables Action
      # #   uses: chillianosson/github-env-vars-action@v2

      # - name: Read commit/pr messages and compare to list of tests
      #   uses: actions/github-script@v6
      #   with:
      #     script: |
      #       const refName = ${{ env.CI_ACTION_REF_NAME }}
      #       const repoPath = ${{ env.CI_REPOSITORY_SLUG }}
      #       const branchName = ${{ env.CI_HEAD_REF }}
      #       console.log('refName is ', refName)
      #       console.log('repoPath is ', repoPath)
      #       console.log('branchName is ', branchName)


